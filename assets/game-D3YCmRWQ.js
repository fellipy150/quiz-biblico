(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))n(t);new MutationObserver(t=>{for(const l of t)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function i(t){const l={};return t.integrity&&(l.integrity=t.integrity),t.referrerPolicy&&(l.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?l.credentials="include":t.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(t){if(t.ep)return;t.ep=!0;const l=i(t);fetch(t.href,l)}})();const v=document.getElementById("lista-quizes"),f=document.getElementById("quiz-stage"),p=document.getElementById("barra-progresso-container"),d=document.getElementById("titulo-quiz"),x=document.getElementById("descricao-quiz"),w=document.getElementById("display-tempo"),h=document.getElementById("contador-perguntas"),q=document.getElementById("tela-selecao");window.perguntas=[];window.indiceAtual=0;window.acertos=0;window.pontuacaoTotal=0;window.modoJogo=null;let $=!1,g=2,T=30,m=30,b,E=0;function z(e){for(let o=e.length-1;o>0;o--){const i=Math.floor(Math.random()*(o+1));[e[o],e[i]]=[e[i],e[o]]}return e}function M(e){return e?e.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br>"):""}function L(){const e=localStorage.getItem("quizSRSData");return e?JSON.parse(e):{}}function D(e){localStorage.setItem("quizSRSData",JSON.stringify(e))}window.resetarMemoriaSRS=function(){confirm("Tem certeza? Isso apagar√° todo o hist√≥rico de aprendizado do Modo Treino.")&&(localStorage.removeItem("quizSRSData"),alert("Mem√≥ria limpa! O algoritmo recome√ßar√° do zero."),location.reload())};function P(e,o,i){const n=L();let t=n[e]||{interval:0,ef:2.5,reps:0},l=0;o?i<10?l=5:i<20?l=4:i<30?l=3:l=2:l=0;let a=t.ef+(.1-(5-l)*(.08+(5-l)*.02));a<1.3&&(a=1.3);let r=1,c=t.reps;l<3?(c=0,r=1):(c++,c===1?r=1:c===2?r=6:r=Math.round(t.interval*a)),n[e]={lastReviewed:Date.now(),interval:r,ef:parseFloat(a.toFixed(2)),reps:c},D(n)}v&&fetch("../quizes/index.json").then(e=>e.json()).then(e=>{v.innerHTML=e.map(o=>`<li><a href="quiz.html?id=${o.arquivo}">${o.titulo}</a></li>`).join("")}).catch(()=>{v.innerHTML='<p style="text-align:center;">Erro ao carregar lista de quizes.</p>'});if(f){const o=new URLSearchParams(window.location.search).get("id");o&&fetch(`../quizes/${o}.md`).then(i=>{if(!i.ok)throw new Error("Arquivo n√£o encontrado");return i.text()}).then(i=>{R(i),q.style.display="flex",f.style.display="none"}).catch(i=>{console.error(i),d&&(d.innerText="Erro ao carregar"),f.innerHTML='<p style="text-align:center">N√£o foi poss√≠vel carregar os dados.</p>',f.style.display="block"})}function R(e){const o=e.replace(/\r\n/g,`
`).split(`
`);let i="",n=!1,t=[],l="Geral",a=null,r=null;o.forEach(c=>{const s=c.trim();if(s.startsWith("```md")){n=!0;return}if(s.startsWith("```")&&n){n=!1;return}if(n){i+=c+`
`;return}if(!s)return;if(s.startsWith("# ")){d&&(d.innerText=s.replace("# ","").trim());return}if(s.startsWith("## "))return;const u=s.match(/^/);if(u&&u[1]!==void 0){l=u[1].trim();return}if(s.startsWith("id:")){a&&S(a,t),a={id:s.replace("id:","").trim(),categoria:l,enunciado:"",opcoes:[],dica:null};return}if(s.startsWith("### ")){a&&(a.enunciado=s.replace("### ","").trim());return}if(s.startsWith("[ ]")||s.startsWith("[x]")){if(a){const y=s.startsWith("[x]");r={texto:s.replace(/\[(x| )\]/,"").trim(),correta:y,explicacao:null},a.opcoes.push(r)}return}if(s.startsWith("-!")&&r){r.explicacao=s.replace("-!","").trim();return}if(s.startsWith("-#")&&a){a.dica=s.replace("-#","").trim();return}}),a&&S(a,t),window.perguntas=t,x&&i&&(x.innerHTML=M(i),x.style.display="block")}function W(e,o){const i=e.replace(/\r\n/g,`
`).split(`
`);let n=[],t=null,l="Geral",a=null;return i.forEach(r=>{const c=r.trim();if(!c)return;const s=c.match(/^/);if(s&&s[1]!==void 0){l=s[1].trim();return}if(c.startsWith("id:")){t&&S(t,n);const u=c.replace("id:","").trim();t={id:`${o.replace(".md","")}-${u}`,categoria:l,enunciado:"",opcoes:[],dica:null};return}if(c.startsWith("### ")&&t){t.enunciado=c.replace("### ","").trim();return}if((c.startsWith("[ ]")||c.startsWith("[x]"))&&t){const u=c.startsWith("[x]");a={texto:c.replace(/\[(x| )\]/,"").trim(),correta:u,explicacao:null},t.opcoes.push(a);return}if(c.startsWith("-!")&&a){a.explicacao=c.replace("-!","").trim();return}c.startsWith("-#")&&t&&(t.dica=c.replace("-#","").trim())}),t&&S(t,n),n}function S(e,o){e.opcoes.filter(n=>n.correta).length===1&&o.push(e)}window.iniciarModoTreino=async function(){d&&(d.innerText="Carregando Mem√≥ria..."),v&&(v.style.display="none"),q&&(q.style.display="none");try{const o=await(await fetch("../quizes.index.json")).json();let i=[];const n=o.map(async c=>{const u=await(await fetch(`data/quizes/${c.arquivo}?t=${Date.now()}`)).text(),y=W(u,c.arquivo);i=i.concat(y)});await Promise.all(n);const t=L(),l=Date.now(),a=864e5,r=i.filter(c=>{const s=t[c.id];if(!s)return!0;const u=s.lastReviewed+s.interval*a;return l>=u});if(r.length===0){alert("üéâ Tudo em dia! Voc√™ revisou todo o conte√∫do pendente. Volte amanh√£."),location.reload();return}window.perguntas=z(r).slice(0,50),d&&(d.innerText=`üß† Treino do Dia (${window.perguntas.length})`),iniciarJogo("treino")}catch(e){console.error("ERRO COMPLETO:",e),alert("Erro T√©cnico: "+e.message),location.reload()}};window.iniciarJogo=function(e){window.perguntas.length!==0&&(window.modoJogo=e,window.indiceAtual=0,window.acertos=0,window.pontuacaoTotal=0,g=2,T=e==="desafio"?15:30,document.body.classList.remove("modo-desafio","modo-treino"),e==="desafio"&&document.body.classList.add("modo-desafio"),e==="treino"&&document.body.classList.add("modo-treino"),q.style.display="none",x&&(x.style.display="none"),d&&(d.style.display="block",d.style.fontSize="1.1rem",d.style.opacity="0.9"),f.style.display="grid",e!=="treino"?(p.style.display="flex",w.style.display="block",h.style.display="block",k()):(p.style.display="none",w.style.display="none",h.style.display="none"),e!=="treino"&&(window.perguntas=z([...window.perguntas])),I(window.perguntas[0],!1))};function k(){p.innerHTML="",window.modoJogo==="desafio"?p.innerHTML='<div class="segmento-barra" id="seg-unico" style="flex: 1;"><div class="fill-tempo"></div></div>':p.innerHTML=window.perguntas.map((e,o)=>`<div class="segmento-barra" id="seg-${o}"><div class="fill-tempo"></div></div>`).join("")}function I(e,o=!0){$=!1,E=Date.now(),h&&(h.innerText=`${window.indiceAtual+1} / ${window.perguntas.length}`);const i=z([...e.opcoes]),n=document.createElement("div");if(n.className="card-quiz",n.innerHTML=`
        <div style="font-size:0.65rem; text-transform:uppercase; opacity:0.5; margin-bottom:4px; font-weight:800; letter-spacing:1px; text-align:center;">
            ${e.categoria}
        </div>
        <div class="pergunta">${e.enunciado}</div>
        <div class="lista-opcoes">
            ${i.map((t,l)=>`
                <div class="opcao-wrapper">
                    <div class="opcao" data-is-correct="${t.correta}" onclick="verificarResposta(${l}, this)">
                        ${t.texto}
                    </div>
                    ${t.explicacao?`
                        <div class="container-explicacao" style="display:none;">
                            <button class="btn-explicacao" onclick="this.nextElementSibling.style.display='block'; this.style.display='none'">
                                üéì Por que?
                            </button>
                            <div class="box-explicacao" style="display:none;">
                                ${M(t.explicacao)}
                            </div>
                        </div>
                    `:""}
                </div>`).join("")}
        </div>
        <div class="area-dica-container">
            ${e.dica?`<button class="btn-dica-minimal" ${g<=0?"disabled":""} onclick="mostrarDica(this, '${e.dica.replace(/'/g,"\\'")}')">üí° Dica <span class="contador-dica">${g}</span></button>`:""}
            <div class="texto-dica-placeholder"></div>
        </div>
        <button id="btn-prox" onclick="transicaoProximaPergunta()">Pr√≥xima Quest√£o ‚ûú</button>
    `,o){n.classList.add("pre-render-direita");const t=f.querySelector(".card-quiz.ativo");f.appendChild(n),n.offsetWidth,t&&(t.classList.replace("ativo","saindo-esquerda"),setTimeout(()=>t.remove(),500)),n.classList.replace("pre-render-direita","ativo")}else n.classList.add("ativo"),f.appendChild(n);window.modoJogo!=="treino"&&(C(),B())}function B(){const e=window.modoJogo==="desafio"?"seg-unico":`seg-${window.indiceAtual}`,o=document.getElementById(e);if(!o)return;o.classList.remove("correto","errado");const i=o.querySelector(".fill-tempo");i.style.transition="none",i.style.width="0%",i.offsetWidth,i.style.transition=`width ${T}s linear`,i.style.width="100%"}function C(){m=T,clearInterval(b),w.innerText=`‚è±Ô∏è ${m}s`,b=setInterval(()=>{m--,w.innerText=`‚è±Ô∏è ${m}s`,m<=0&&(clearInterval(b),window.modoJogo==="desafio"?A("Tempo esgotado!"):verificarResposta(-1,null))},1e3)}window.verificarResposta=function(e,o){if($)return;const i=(Date.now()-E)/1e3;if($=!0,clearInterval(b),window.modoJogo!=="treino"){const r=window.modoJogo==="desafio"?"seg-unico":`seg-${window.indiceAtual}`,c=document.getElementById(r);if(c){const s=c.querySelector(".fill-tempo");s.style.width=window.getComputedStyle(s).width,s.style.transition="none"}}const n=document.querySelector(".card-quiz.ativo"),t=n.querySelectorAll(".opcao"),l=n.querySelectorAll(".container-explicacao");let a=!1;if(t.forEach((r,c)=>{r.classList.add("bloqueado"),r.getAttribute("data-is-correct")==="true"?(r.classList.add("correta"),r===o&&(a=!0)):r===o&&r.classList.add("errada")}),l.forEach(r=>{r.style.display="block",r.style.animation="fadeIn 0.5s ease"}),window.modoJogo==="treino"){const r=window.perguntas[window.indiceAtual];P(r.id,a,i),n.querySelector("#btn-prox").style.display="block";return}if(a){window.acertos++;let r=window.modoJogo==="desafio"?15:10;window.pontuacaoTotal+=r+Math.round(r*(m/T))}if(window.modoJogo==="desafio"&&!a){setTimeout(()=>A(e===-1?"Tempo Esgotado!":"Voc√™ Errou!"),1200);return}if(window.modoJogo==="normal"){const r=document.getElementById(`seg-${window.indiceAtual}`);r&&r.classList.add(a?"correto":"errado")}n.querySelector("#btn-prox").style.display="block"};window.mostrarDica=function(e,o){if(g<=0)return;g--,e.disabled=!0,e.innerHTML=`üí° Dica <span class="contador-dica">${g}</span>`;const i=document.querySelector(".card-quiz.ativo .texto-dica-placeholder");i.innerHTML=`<div class="box-dica-texto">${o}</div>`};window.transicaoProximaPergunta=function(){window.indiceAtual++,window.indiceAtual>=window.perguntas.length?window.modoJogo==="treino"?J():O():I(window.perguntas[window.indiceAtual],!0)};function A(e){d&&(d.style.fontSize="1.3rem"),f.innerHTML=`<div class="card-quiz ativo" style="text-align:center; border: 2px solid var(--error);"><h2 style="font-size:3rem;">‚ò†Ô∏è</h2><h3 style="color:var(--error);">${e}</h3><p>Fim de jogo no desafio.</p><button onclick="location.reload()" style="background:var(--error); color:white; padding:15px; border-radius:12px; border:none; width:100%; font-weight:bold; cursor:pointer; margin-top:20px;">Tentar Novamente</button></div>`,w.style.display="none",h.style.display="none",p.style.display="none"}function J(){d&&(d.style.fontSize="1.3rem"),f.innerHTML=`
    <div class="card-quiz ativo" style="text-align:center;">
      <h2 style="color:#4f46e5;">‚úÖ Treino Conclu√≠do!</h2>
      <p style="margin:20px 0; line-height:1.5;">Voc√™ revisou todas as cartas pendentes por agora. O algoritmo de repeti√ß√£o espa√ßada calcular√° quando voc√™ deve ver estas quest√µes novamente.</p>
      <button onclick="location.reload()" style="background:#4f46e5; color:white; padding:15px; width:100%; border:none; border-radius:12px; font-weight:bold; cursor:pointer; font-size:1.1rem; margin-top:10px;">Voltar ao Menu</button>
    </div>`,document.body.classList.remove("modo-treino")}function O(){d&&(d.style.fontSize="1.3rem");const o=window.acertos/window.perguntas.length>=.6;w.style.display="none",h.style.display="none",p.style.display="none",f.innerHTML=`<div class="card-quiz ativo" style="text-align:center;"><h2>${o?"Incr√≠vel!":"Bom Treino!"}</h2><div style="font-size: 3.5rem; color: ${o?"var(--brand-green)":"var(--error)"}; font-weight:800; margin: 15px 0;">${window.pontuacaoTotal} <span style="font-size:1.5rem">pts</span></div><p style="font-weight:600;">Voc√™ acertou ${window.acertos} de ${window.perguntas.length}</p><hr style="border:0; border-top:1px solid #eee; margin:20px 0;"><h3>Salvar no Ranking</h3><input type="text" id="input-nome-jogador" maxlength="15" placeholder="seu nome" oninput="this.value = this.value.toLowerCase().replace(/[^a-z√†-√∫√ß ]/g, '')"><button id="btn-salvar-final" onclick="enviarPontuacao()" style="background:#2563eb; color:white; padding:15px; width:100%; border:none; border-radius:12px; font-weight:bold; cursor:pointer; font-size:1.1rem; margin-top:10px;">üíæ Salvar Conquista</button><button onclick="location.reload()" style="background:transparent; border:1px solid #ccc; padding:10px; width:100%; margin-top:10px; border-radius:12px; cursor:pointer;">Menu Principal</button></div>`,o&&H()}function H(){const e=document.getElementById("canvas-confete");if(!e)return;const o=e.getContext("2d");e.width=window.innerWidth,e.height=window.innerHeight;const i=Array.from({length:120},()=>({x:Math.random()*e.width,y:Math.random()*e.height-e.height,w:Math.random()*10+5,h:Math.random()*10+5,color:["#ff0","#0f0","#00f","#f0f","#0ff","#fff"][Math.floor(Math.random()*6)],s:Math.random()*3+2,a:Math.random()*360}));function n(){o.clearRect(0,0,e.width,e.height),i.forEach(t=>{o.fillStyle=t.color,o.fillRect(t.x,t.y,t.w,t.h),t.y+=t.s,t.a+=.1,t.y>e.height&&(t.y=-10)}),e.width>0&&requestAnimationFrame(n)}n(),setTimeout(()=>{e.width=0},5e3)}
