(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const d of n.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function a(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(s){if(s.ep)return;s.ep=!0;const n=a(s);fetch(s.href,n)}})();function v(t){try{if(!Array.isArray(t))throw new Error("O par√¢metro fornecido n√£o √© um array.");const r=[...t];for(let a=r.length-1;a>0;a--){const i=Math.floor(Math.random()*(a+1));[r[a],r[i]]=[r[i],r[a]]}return r}catch(r){return console.error("Erro ao embaralhar array:",r),t}}function E(t){try{return t?t.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br>"):""}catch(r){return console.error("Erro ao converter Markdown Simples:",r),t||""}}function y(t,r){try{t.opcoes.filter(i=>i.correta).length>=1?r.push(t):console.warn(`Pergunta ID: ${t.id} descartada: Nenhuma op√ß√£o correta definida.`)}catch(a){console.error("Erro na valida√ß√£o da pergunta:",a,t)}}function w(t){try{if(typeof t!="string")throw new Error("A entrada do quiz deve ser uma string Markdown.");const r=t.replace(/\r\n/g,`
`).split(`
`);let a={titulo:"",descricao:"",perguntas:[]},i="",s=!1,n="Geral",d=null,c=null;return r.forEach((u,f)=>{try{const l=u.trim();if(l.startsWith("```md")){s=!0;return}if(l.startsWith("```")&&s){s=!1;return}if(s){i+=u+`
`;return}if(!l)return;if(l.startsWith("# ")){a.titulo=l.replace("# ","").trim();return}if(l.startsWith("## "))return;const g=l.match(/^__(.*?)__$/);if(g&&g[1]!==void 0){n=g[1].trim();return}if(l.startsWith("id:")){d&&y(d,a.perguntas),d={id:l.replace("id:","").trim(),categoria:n,enunciado:"",opcoes:[],dica:null};return}if(l.startsWith("### ")){d&&(d.enunciado=l.replace("### ","").trim());return}if(l.startsWith("[ ]")||l.startsWith("[x]")){if(d){const M=l.startsWith("[x]");c={texto:l.replace(/\[(x| )\]/,"").trim(),correta:M,explicacao:null},d.opcoes.push(c)}return}if((l.startsWith("-!")||l.startsWith("-["))&&c){c.explicacao=l.replace(/^(-!|-\[|\])/g,"").trim();return}if(l.startsWith("-#")&&d){d.dica=l.replace("-#","").trim();return}}catch(l){console.error(`Erro ao processar a linha ${f+1}: "${u}"`,l)}}),d&&y(d,a.perguntas),a.descricao=E(i),a}catch(r){return console.error("Falha cr√≠tica no parseMarkdownQuiz:",r),{titulo:"Erro no carregamento",descricao:"",perguntas:[]}}}function q(t,r){try{const a=w(t);return!a||!a.perguntas?[]:a.perguntas.map(i=>({...i,id:`${r.replace(".md","")}-${i.id}`}))}catch(a){return console.error(`Erro em extrairPerguntasMass (Arquivo: ${r}):`,a),[]}}const h="quizSRSData";function x(){try{const t=localStorage.getItem(h);return t?JSON.parse(t):{}}catch(t){return console.error("Erro ao ler SRS do LocalStorage (Dados corrompidos?):",t),{}}}function R(t){try{const r=JSON.stringify(t);localStorage.setItem(h,r)}catch(r){console.error("Erro ao salvar SRS no LocalStorage:",r),r.name==="QuotaExceededError"&&console.warn("Aviso: LocalStorage est√° cheio. O progresso pode n√£o ser salvo.")}}function z(){try{confirm("Tem certeza? Isso apagar√° todo o hist√≥rico de aprendizado do Modo Treino.")&&(localStorage.removeItem(h),alert("Mem√≥ria limpa! O algoritmo recome√ßar√° do zero."),location.reload())}catch(t){console.error("Erro ao resetar mem√≥ria SRS:",t),alert("N√£o foi poss√≠vel limpar os dados. Tente limpar o cache do navegador.")}}function A(t,r,a){try{if(!t)throw new Error("ID da quest√£o n√£o fornecido.");const i=x();let s=i[t]||{lastReviewed:0,interval:0,ef:2.5,reps:0},n=0;r?a<10?n=5:a<20?n=4:a<30?n=3:n=2:n=0;let d=s.ef+(.1-(5-n)*(.08+(5-n)*.02));d<1.3&&(d=1.3);let c=1,u=s.reps;n<3?(u=0,c=1):(u++,u===1?c=1:u===2?c=6:c=Math.round(s.interval*d)),i[t]={lastReviewed:Date.now(),interval:c,ef:parseFloat(d.toFixed(2)),reps:u},R(i)}catch(i){console.error(`Erro cr√≠tico ao processar algoritmo SRS para ID ${t}:`,i)}}const m=t=>{try{return`/quiz-biblico//${t}`.replace(/\/+/g,"/")}catch{return t}},p=t=>document.getElementById(t),e={lista:p("lista-quizes"),stage:p("quiz-stage"),progresso:p("barra-progresso-container"),titulo:p("titulo-quiz"),descricao:p("descricao-quiz"),tempo:p("display-tempo"),contador:p("contador-perguntas"),selecao:p("tela-selecao"),confete:p("canvas-confete")},o={perguntas:[],indiceAtual:0,acertos:0,pontuacaoTotal:0,modoJogo:null,respondido:!1,dicasRestantes:2,tempoTotal:30,tempoRestante:30,timerInterval:null,srsStartTime:0};window.iniciarJogo=t=>b(t);window.iniciarModoTreino=()=>P();window.verificarResposta=(t,r)=>S(t,r);window.mostrarDica=(t,r)=>W(t,r);window.transicaoProximaPergunta=()=>N();window.resetarMemoriaSRS=z;function L(){I(),D()}function I(){e.lista&&fetch(m("quizes/index.json")).then(t=>t.ok?t.json():[]).then(t=>{t.length&&(e.lista.innerHTML=t.map(r=>`<li><a href="quiz.html?id=${r.arquivo}">${r.titulo}</a></li>`).join(""))}).catch(console.error)}function D(){if(!e.stage)return;const r=new URLSearchParams(window.location.search).get("id");r&&fetch(m(`quizes/${r}.md`)).then(a=>{if(!a.ok)throw new Error("Quiz n√£o encontrado");return a.text()}).then(a=>{const i=w(a);e.titulo&&(e.titulo.innerText=i.titulo||"Quiz"),e.descricao&&i.descricao&&(e.descricao.innerHTML=i.descricao,e.descricao.style.display="block"),o.perguntas=i.perguntas,e.selecao&&(e.selecao.style.display="flex"),e.stage&&(e.stage.style.display="none")}).catch(a=>{console.error(a),e.titulo&&(e.titulo.innerText="Erro ao carregar"),e.stage.innerHTML='<div class="card-quiz error">Erro ao carregar quiz. Verifique a URL.</div>',e.stage.style.display="block"})}async function P(){e.titulo&&(e.titulo.innerText="Carregando Mem√≥ria..."),e.lista&&(e.lista.style.display="none"),e.selecao&&(e.selecao.style.display="none");try{const r=await(await fetch(m("quizes/index.json"))).json();let a=[];const i=r.map(async f=>{try{const l=await fetch(m(`quizes/${f.arquivo}.md?t=${Date.now()}`));if(!l.ok)return[];const g=await l.text();return q(g,f.arquivo)}catch{return[]}});(await Promise.all(i)).forEach(f=>a.push(...f));const n=x(),d=Date.now(),c=864e5,u=a.filter(f=>{const l=n[f.id];return l?d>=l.lastReviewed+l.interval*c:!0});if(u.length===0){alert("üéâ Tudo em dia! Voc√™ revisou todo o conte√∫do pendente."),window.location.href="index.html";return}o.perguntas=v(u).slice(0,50),e.titulo&&(e.titulo.innerText=`üß† Treino do Dia (${o.perguntas.length})`),b("treino")}catch(t){console.error(t),alert("Erro ao iniciar treino."),location.reload()}}function b(t){o.modoJogo=t,o.indiceAtual=0,o.acertos=0,o.pontuacaoTotal=0,o.dicasRestantes=2,o.tempoTotal=t==="desafio"?15:30,window.pontuacaoTotal=0,window.modoJogo=t,e.selecao&&(e.selecao.style.display="none"),e.descricao&&(e.descricao.style.display="none"),e.titulo&&(e.titulo.style.display="block"),e.stage&&(e.stage.style.display="grid"),t!=="treino"?(e.progresso&&(e.progresso.style.display="flex"),e.tempo&&(e.tempo.style.display="block"),e.contador&&(e.contador.style.display="block"),J()):(e.progresso&&(e.progresso.style.display="none"),e.tempo&&(e.tempo.style.display="none"),e.contador&&(e.contador.style.display="none")),o.perguntas.length>0?T(o.perguntas[0]):alert("Nenhuma pergunta encontrada.")}function J(){e.progresso&&(e.progresso.innerHTML="",o.modoJogo==="desafio"?e.progresso.innerHTML='<div class="segmento-barra" id="seg-unico" style="flex: 1;"><div class="fill-tempo"></div></div>':e.progresso.innerHTML=o.perguntas.map((t,r)=>`<div class="segmento-barra" id="seg-${r}"><div class="fill-tempo"></div></div>`).join(""))}function T(t){o.respondido=!1,o.srsStartTime=Date.now(),e.contador&&(e.contador.innerText=`${o.indiceAtual+1} / ${o.perguntas.length}`);const r=v([...t.opcoes]),a=document.createElement("div");a.className="card-quiz ativo",a.innerHTML=`
    <div style="font-size:0.65rem; text-transform:uppercase; opacity:0.5; margin-bottom:4px; font-weight:800; letter-spacing:1px; text-align:center;">
        ${t.categoria||"Geral"}
    </div>
    <div class="pergunta">${t.enunciado}</div>
    <div class="lista-opcoes">
        ${r.map((i,s)=>`
            <div class="opcao-wrapper">
                <div class="opcao" data-is-correct="${i.correta}" onclick="window.verificarResposta(${s}, this)">
                    ${i.texto}
                </div>
            </div>`).join("")}
    </div>
    <div class="area-dica-container">
        ${t.dica?`<button class="btn-dica-minimal" onclick="window.mostrarDica(this, '${t.dica.replace(/'/g,"\\'")}')">üí° Dica</button>`:""}
        <div class="texto-dica-placeholder"></div>
    </div>
    <button id="btn-prox" style="display:none; margin-top:15px; width:100%; padding:12px;" onclick="window.transicaoProximaPergunta()">Pr√≥xima Quest√£o ‚ûú</button>
  `,e.stage&&(e.stage.innerHTML="",e.stage.appendChild(a)),o.modoJogo!=="treino"&&(O(),H())}function H(){const t=o.modoJogo==="desafio"?"seg-unico":`seg-${o.indiceAtual}`,r=document.getElementById(t);if(!r)return;r.classList.remove("correto","errado");const a=r.querySelector(".fill-tempo");a&&(a.style.transition="none",a.style.width="0%",a.offsetWidth,a.style.transition=`width ${o.tempoTotal}s linear`,a.style.width="100%")}function O(){e.tempo&&(o.tempoRestante=o.tempoTotal,clearInterval(o.timerInterval),e.tempo.innerText=`‚è±Ô∏è ${o.tempoRestante}s`,o.timerInterval=setInterval(()=>{o.tempoRestante--,e.tempo.innerText=`‚è±Ô∏è ${o.tempoRestante}s`,o.tempoRestante<=0&&(clearInterval(o.timerInterval),o.modoJogo==="desafio"?$("Tempo Esgotado!"):S(-1,null))},1e3))}function S(t,r){if(o.respondido)return;const a=(Date.now()-o.srsStartTime)/1e3;if(o.respondido=!0,clearInterval(o.timerInterval),o.modoJogo!=="treino"){const c=o.modoJogo==="desafio"?"seg-unico":`seg-${o.indiceAtual}`,u=document.getElementById(c);if(u){const f=u.querySelector(".fill-tempo");f&&(f.style.width=window.getComputedStyle(f).width,f.style.transition="none")}}const i=document.querySelector(".card-quiz.ativo");if(!i)return;const s=i.querySelectorAll(".opcao");let n=!1;if(s.forEach(c=>{c.classList.add("bloqueado"),c.getAttribute("data-is-correct")==="true"?(c.classList.add("correta"),c===r&&(n=!0)):c===r&&c.classList.add("errada")}),o.modoJogo==="treino"){const c=o.perguntas[o.indiceAtual];A(c.id,n,a)}else{if(n){o.acertos++;let c=o.modoJogo==="desafio"?15:10;o.pontuacaoTotal+=c+Math.round(c*(o.tempoRestante/o.tempoTotal))}if(window.pontuacaoTotal=o.pontuacaoTotal,o.modoJogo==="normal"){const c=document.getElementById(`seg-${o.indiceAtual}`);c&&c.classList.add(n?"correto":"errado")}if(o.modoJogo==="desafio"&&!n){setTimeout(()=>$("Voc√™ Errou!"),1e3);return}}const d=i.querySelector("#btn-prox");d&&(d.style.display="block")}function W(t,r){if(o.dicasRestantes<=0)return;o.dicasRestantes--,t.disabled=!0,t.innerHTML=`üí° Dica (${o.dicasRestantes})`;const a=document.querySelector(".card-quiz.ativo .texto-dica-placeholder");a&&(a.innerHTML=`<div class="box-dica-texto">${r}</div>`)}function N(){o.indiceAtual++,o.indiceAtual>=o.perguntas.length?o.modoJogo==="treino"?k():C():T(o.perguntas[o.indiceAtual])}function $(t){e.stage&&(e.stage.innerHTML=`
        <div class="card-quiz ativo" style="text-align:center; border: 2px solid var(--error);">
            <h2 style="font-size:3rem;">‚ò†Ô∏è</h2>
            <h3 style="color:var(--error);">${t}</h3>
            <p>Fim de jogo.</p>
            <p>Pontua√ß√£o Final: <strong>${o.pontuacaoTotal}</strong></p>
            <button onclick="location.reload()" style="background:var(--error); color:white; padding:15px; border-radius:12px; border:none; width:100%; font-weight:bold; cursor:pointer; margin-top:20px;">Tentar Novamente</button>
            <br><br>
            <a href="index.html" style="color:#666; text-decoration:none;">Voltar ao Menu</a>
        </div>`),e.tempo&&(e.tempo.style.display="none"),e.contador&&(e.contador.style.display="none"),e.progresso&&(e.progresso.style.display="none")}function k(){e.stage&&(e.stage.innerHTML=`
        <div class="card-quiz ativo" style="text-align:center;">
          <h2 style="color:#4f46e5;">‚úÖ Treino Conclu√≠do!</h2>
          <p style="margin:20px 0;">Voc√™ revisou todas as cartas pendentes.</p>
          <a href="index.html"><button style="background:#4f46e5; color:white; padding:15px; width:100%; border:none; border-radius:12px; font-weight:bold; cursor:pointer;">Voltar ao Menu</button></a>
        </div>`)}function C(){const r=o.acertos/o.perguntas.length>=.6;e.tempo&&(e.tempo.style.display="none"),e.contador&&(e.contador.style.display="none"),e.progresso&&(e.progresso.style.display="none"),e.stage&&(e.stage.innerHTML=`
        <div class="card-quiz ativo" style="text-align:center;">
            <h2>${r?"Muito Bem!":"Bom Treino!"}</h2>
            <div style="font-size: 3.5rem; color: ${r?"var(--brand-green)":"var(--error)"}; font-weight:800; margin: 15px 0;">
                ${o.pontuacaoTotal} <span style="font-size:1.5rem">pts</span>
            </div>
            <p style="font-weight:600;">Acertos: ${o.acertos} / ${o.perguntas.length}</p>
            <hr style="border:0; border-top:1px solid #eee; margin:20px 0;">
            <button onclick="location.reload()" style="background:var(--brand-green); color:white; padding:12px; width:100%; border:none; border-radius:8px; margin-bottom:10px; cursor:pointer;">Jogar Novamente</button>
            <a href="index.html"><button style="background:transparent; border:1px solid #ccc; padding:12px; width:100%; border-radius:8px; cursor:pointer;">Menu Principal</button></a>
        </div>`),r&&B()}function B(){if(!e.confete)return;const t=e.confete.getContext("2d");e.confete.width=window.innerWidth,e.confete.height=window.innerHeight;const r=Array.from({length:100},()=>({x:Math.random()*e.confete.width,y:-20,c:"#"+Math.floor(Math.random()*16777215).toString(16),s:2+Math.random()*3}));function a(){t.clearRect(0,0,e.confete.width,e.confete.height),r.forEach(i=>{t.fillStyle=i.c,t.fillRect(i.x,i.y+=i.s,5,5),i.y>e.confete.height&&(i.y=-20)}),e.confete.width>0&&requestAnimationFrame(a)}a(),setTimeout(()=>{e.confete.width=0},5e3)}L();
