(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function a(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(n){if(n.ep)return;n.ep=!0;const l=a(n);fetch(n.href,l)}})();function m(o){const i=[...o];for(let a=i.length-1;a>0;a--){const r=Math.floor(Math.random()*(a+1));[i[a],i[r]]=[i[r],i[a]]}return i}function h(o){return o?o.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br>"):""}function y(o,i){o.opcoes.filter(r=>r.correta).length>=1&&i.push(o)}function v(o){const i=o.replace(/\r\n/g,`
`).split(`
`);let a={titulo:"",descricao:"",perguntas:[]},r="",n=!1,l="Geral",d=null,s=null;return i.forEach(u=>{const c=u.trim();if(c.startsWith("```md")){n=!0;return}if(c.startsWith("```")&&n){n=!1;return}if(n){r+=u+`
`;return}if(!c)return;if(c.startsWith("# ")){a.titulo=c.replace("# ","").trim();return}if(c.startsWith("## "))return;const f=c.match(/^__(.*?)__$/);if(f&&f[1]!==void 0){l=f[1].trim();return}if(c.startsWith("id:")){d&&y(d,a.perguntas),d={id:c.replace("id:","").trim(),categoria:l,enunciado:"",opcoes:[],dica:null};return}if(c.startsWith("### ")){d&&(d.enunciado=c.replace("### ","").trim());return}if(c.startsWith("[ ]")||c.startsWith("[x]")){if(d){const p=c.startsWith("[x]");s={texto:c.replace(/\[(x| )\]/,"").trim(),correta:p,explicacao:null},d.opcoes.push(s)}return}if((c.startsWith("-!")||c.startsWith("-["))&&s){s.explicacao=c.replace(/^(-!|-\[|\])/g,"").trim();return}if(c.startsWith("-#")&&d){d.dica=c.replace("-#","").trim();return}}),d&&y(d,a.perguntas),a.descricao=h(r),a}function $(o,i){return v(o).perguntas.map(r=>({...r,id:`${i.replace(".md","")}-${r.id}`}))}const g="quizSRSData";function w(){const o=localStorage.getItem(g);return o?JSON.parse(o):{}}function M(o){localStorage.setItem(g,JSON.stringify(o))}function q(){confirm("Tem certeza? Isso apagar√° todo o hist√≥rico de aprendizado do Modo Treino.")&&(localStorage.removeItem(g),alert("Mem√≥ria limpa! O algoritmo recome√ßar√° do zero."),location.reload())}function z(o,i,a){const r=w();let n=r[o]||{interval:0,ef:2.5,reps:0},l=0;i?a<10?l=5:a<20?l=4:a<30?l=3:l=2:l=0;let d=n.ef+(.1-(5-l)*(.08+(5-l)*.02));d<1.3&&(d=1.3);let s=1,u=n.reps;l<3?(u=0,s=1):(u++,u===1?s=1:u===2?s=6:s=Math.round(n.interval*d)),r[o]={lastReviewed:Date.now(),interval:s,ef:parseFloat(d.toFixed(2)),reps:u},M(r)}const e={lista:document.getElementById("lista-quizes"),stage:document.getElementById("quiz-stage"),progresso:document.getElementById("barra-progresso-container"),titulo:document.getElementById("titulo-quiz"),descricao:document.getElementById("descricao-quiz"),tempo:document.getElementById("display-tempo"),contador:document.getElementById("contador-perguntas"),selecao:document.getElementById("tela-selecao"),confete:document.getElementById("canvas-confete")},t={perguntas:[],indiceAtual:0,acertos:0,pontuacaoTotal:0,modoJogo:null,respondido:!1,dicasRestantes:2,tempoTotal:30,tempoRestante:30,timerInterval:null,srsStartTime:0};function L(){R(),I()}function R(){e.lista&&fetch("../quizes/index.json").then(o=>o.json()).then(o=>{e.lista.innerHTML=o.map(i=>`<li><a href="quiz.html?id=${i.arquivo}">${i.titulo}</a></li>`).join("")}).catch(()=>{e.lista.innerHTML='<p style="text-align:center;">Erro ao carregar lista.</p>'})}function I(){if(!e.stage)return;const i=new URLSearchParams(window.location.search).get("id");i&&fetch(`../quizes/${i}.md`).then(a=>{if(!a.ok)throw new Error("Arquivo n√£o encontrado");return a.text()}).then(a=>{const r=v(a);e.titulo&&(e.titulo.innerText=r.titulo||"Quiz"),e.descricao&&r.descricao&&(e.descricao.innerHTML=r.descricao,e.descricao.style.display="block"),t.perguntas=r.perguntas,e.selecao.style.display="flex",e.stage.style.display="none"}).catch(a=>{console.error(a),e.titulo&&(e.titulo.innerText="Erro ao carregar"),e.stage.innerHTML='<p style="text-align:center">N√£o foi poss√≠vel carregar os dados.</p>',e.stage.style.display="block"})}async function E(){e.titulo&&(e.titulo.innerText="Carregando Mem√≥ria..."),e.lista&&(e.lista.style.display="none"),e.selecao&&(e.selecao.style.display="none");try{const i=await(await fetch("../quizes/index.json")).json();let a=[];const r=i.map(async c=>{const p=await(await fetch(`../quizes/${c.arquivo}?t=${Date.now()}`)).text();return $(p,c.arquivo)});(await Promise.all(r)).forEach(c=>a.push(...c));const l=w(),d=Date.now(),s=864e5,u=a.filter(c=>{const f=l[c.id];if(!f)return!0;const p=f.lastReviewed+f.interval*s;return d>=p});if(u.length===0){alert("üéâ Tudo em dia! Voc√™ revisou todo o conte√∫do pendente. Volte amanh√£."),location.reload();return}t.perguntas=m(u).slice(0,50),e.titulo&&(e.titulo.innerText=`üß† Treino do Dia (${t.perguntas.length})`),x("treino")}catch(o){console.error("ERRO TREINO:",o),alert("Erro ao iniciar treino."),location.reload()}}function x(o){t.perguntas.length!==0&&(t.modoJogo=o,t.indiceAtual=0,t.acertos=0,t.pontuacaoTotal=0,t.dicasRestantes=2,t.tempoTotal=o==="desafio"?15:30,document.body.classList.remove("modo-desafio","modo-treino"),o==="desafio"&&document.body.classList.add("modo-desafio"),o==="treino"&&document.body.classList.add("modo-treino"),e.selecao.style.display="none",e.descricao&&(e.descricao.style.display="none"),e.titulo&&(e.titulo.style.display="block",e.titulo.style.fontSize="1.1rem"),e.stage.style.display="grid",o!=="treino"?(e.progresso.style.display="flex",e.tempo.style.display="block",e.contador.style.display="block",A(),t.perguntas=m([...t.perguntas])):(e.progresso.style.display="none",e.tempo.style.display="none",e.contador.style.display="none"),b(t.perguntas[0],!1))}function A(){e.progresso.innerHTML="",t.modoJogo==="desafio"?e.progresso.innerHTML='<div class="segmento-barra" id="seg-unico" style="flex: 1;"><div class="fill-tempo"></div></div>':e.progresso.innerHTML=t.perguntas.map((o,i)=>`<div class="segmento-barra" id="seg-${i}"><div class="fill-tempo"></div></div>`).join("")}function b(o,i=!0){t.respondido=!1,t.srsStartTime=Date.now(),e.contador&&(e.contador.innerText=`${t.indiceAtual+1} / ${t.perguntas.length}`);const a=m([...o.opcoes]),r=document.createElement("div");if(r.className="card-quiz",r.innerHTML=`
        <div style="font-size:0.65rem; text-transform:uppercase; opacity:0.5; margin-bottom:4px; font-weight:800; letter-spacing:1px; text-align:center;">
            ${o.categoria}
        </div>
        <div class="pergunta">${o.enunciado}</div>
        <div class="lista-opcoes">
            ${a.map((n,l)=>`
                <div class="opcao-wrapper">
                    <div class="opcao" data-is-correct="${n.correta}" onclick="window.verificarResposta(${l}, this)">
                        ${n.texto}
                    </div>
                    ${n.explicacao?`
                        <div class="container-explicacao" style="display:none;">
                            <button class="btn-explicacao" onclick="this.nextElementSibling.style.display='block'; this.style.display='none'">
                                üéì Por que?
                            </button>
                            <div class="box-explicacao" style="display:none;">
                                ${h(n.explicacao)}
                            </div>
                        </div>
                    `:""}
                </div>`).join("")}
        </div>
        <div class="area-dica-container">
            ${o.dica?`<button class="btn-dica-minimal" ${t.dicasRestantes<=0?"disabled":""} onclick="window.mostrarDica(this, '${o.dica.replace(/'/g,"\\'")}')">üí° Dica <span class="contador-dica">${t.dicasRestantes}</span></button>`:""}
            <div class="texto-dica-placeholder"></div>
        </div>
        <button id="btn-prox" onclick="window.transicaoProximaPergunta()">Pr√≥xima Quest√£o ‚ûú</button>
    `,i){r.classList.add("pre-render-direita");const n=e.stage.querySelector(".card-quiz.ativo");e.stage.appendChild(r),r.offsetWidth,n&&(n.classList.replace("ativo","saindo-esquerda"),setTimeout(()=>n.remove(),500)),r.classList.replace("pre-render-direita","ativo")}else r.classList.add("ativo"),e.stage.appendChild(r);t.modoJogo!=="treino"&&(D(),P())}function P(){const o=t.modoJogo==="desafio"?"seg-unico":`seg-${t.indiceAtual}`,i=document.getElementById(o);if(!i)return;i.classList.remove("correto","errado");const a=i.querySelector(".fill-tempo");a.style.transition="none",a.style.width="0%",a.offsetWidth,a.style.transition=`width ${t.tempoTotal}s linear`,a.style.width="100%"}function D(){t.tempoRestante=t.tempoTotal,clearInterval(t.timerInterval),e.tempo.innerText=`‚è±Ô∏è ${t.tempoRestante}s`,t.timerInterval=setInterval(()=>{t.tempoRestante--,e.tempo.innerText=`‚è±Ô∏è ${t.tempoRestante}s`,t.tempoRestante<=0&&(clearInterval(t.timerInterval),t.modoJogo==="desafio"?S("Tempo esgotado!"):T(-1,null))},1e3)}function T(o,i){if(t.respondido)return;const a=(Date.now()-t.srsStartTime)/1e3;if(t.respondido=!0,clearInterval(t.timerInterval),t.modoJogo!=="treino"){const s=t.modoJogo==="desafio"?"seg-unico":`seg-${t.indiceAtual}`,u=document.getElementById(s);if(u){const c=u.querySelector(".fill-tempo");c.style.width=window.getComputedStyle(c).width,c.style.transition="none"}}const r=document.querySelector(".card-quiz.ativo"),n=r.querySelectorAll(".opcao"),l=r.querySelectorAll(".container-explicacao");let d=!1;if(n.forEach((s,u)=>{s.classList.add("bloqueado"),s.getAttribute("data-is-correct")==="true"?(s.classList.add("correta"),s===i&&(d=!0)):s===i&&s.classList.add("errada")}),l.forEach(s=>{s.style.display="block",s.style.animation="fadeIn 0.5s ease"}),t.modoJogo==="treino"){const s=t.perguntas[t.indiceAtual];z(s.id,d,a),r.querySelector("#btn-prox").style.display="block";return}if(d){t.acertos++;let s=t.modoJogo==="desafio"?15:10;t.pontuacaoTotal+=s+Math.round(s*(t.tempoRestante/t.tempoTotal))}if(t.modoJogo==="desafio"&&!d){setTimeout(()=>S(o===-1?"Tempo Esgotado!":"Voc√™ Errou!"),1200);return}if(t.modoJogo==="normal"){const s=document.getElementById(`seg-${t.indiceAtual}`);s&&s.classList.add(d?"correto":"errado")}r.querySelector("#btn-prox").style.display="block"}function B(o,i){if(t.dicasRestantes<=0)return;t.dicasRestantes--,o.disabled=!0,o.innerHTML=`üí° Dica <span class="contador-dica">${t.dicasRestantes}</span>`;const a=document.querySelector(".card-quiz.ativo .texto-dica-placeholder");a.innerHTML=`<div class="box-dica-texto">${i}</div>`}function J(){t.indiceAtual++,t.indiceAtual>=t.perguntas.length?t.modoJogo==="treino"?k():W():b(t.perguntas[t.indiceAtual],!0)}function S(o){e.titulo&&(e.titulo.style.fontSize="1.3rem"),e.stage.innerHTML=`<div class="card-quiz ativo" style="text-align:center; border: 2px solid var(--error);"><h2 style="font-size:3rem;">‚ò†Ô∏è</h2><h3 style="color:var(--error);">${o}</h3><p>Fim de jogo no desafio.</p><button onclick="location.reload()" style="background:var(--error); color:white; padding:15px; border-radius:12px; border:none; width:100%; font-weight:bold; cursor:pointer; margin-top:20px;">Tentar Novamente</button></div>`,e.tempo.style.display="none",e.contador.style.display="none",e.progresso.style.display="none"}function k(){e.titulo&&(e.titulo.style.fontSize="1.3rem"),e.stage.innerHTML=`
    <div class="card-quiz ativo" style="text-align:center;">
      <h2 style="color:#4f46e5;">‚úÖ Treino Conclu√≠do!</h2>
      <p style="margin:20px 0; line-height:1.5;">Voc√™ revisou todas as cartas pendentes por agora.</p>
      <button onclick="location.reload()" style="background:#4f46e5; color:white; padding:15px; width:100%; border:none; border-radius:12px; font-weight:bold; cursor:pointer; font-size:1.1rem; margin-top:10px;">Voltar ao Menu</button>
    </div>`,document.body.classList.remove("modo-treino")}function W(){e.titulo&&(e.titulo.style.fontSize="1.3rem");const i=t.acertos/t.perguntas.length>=.6;e.tempo.style.display="none",e.contador.style.display="none",e.progresso.style.display="none",e.stage.innerHTML=`
    <div class="card-quiz ativo" style="text-align:center;">
        <h2>${i?"Incr√≠vel!":"Bom Treino!"}</h2>
        <div style="font-size: 3.5rem; color: ${i?"var(--brand-green)":"var(--error)"}; font-weight:800; margin: 15px 0;">
            ${t.pontuacaoTotal} <span style="font-size:1.5rem">pts</span>
        </div>
        <p style="font-weight:600;">Voc√™ acertou ${t.acertos} de ${t.perguntas.length}</p>
        <hr style="border:0; border-top:1px solid #eee; margin:20px 0;">
        <button onclick="location.reload()" style="background:transparent; border:1px solid #ccc; padding:10px; width:100%; margin-top:10px; border-radius:12px; cursor:pointer;">Menu Principal</button>
    </div>`,i&&H()}function H(){if(!e.confete)return;const o=e.confete.getContext("2d");e.confete.width=window.innerWidth,e.confete.height=window.innerHeight;const i=Array.from({length:120},()=>({x:Math.random()*e.confete.width,y:Math.random()*e.confete.height-e.confete.height,w:Math.random()*10+5,h:Math.random()*10+5,color:["#ff0","#0f0","#00f","#f0f","#0ff","#fff"][Math.floor(Math.random()*6)],s:Math.random()*3+2,a:Math.random()*360}));function a(){o.clearRect(0,0,e.confete.width,e.confete.height),i.forEach(r=>{o.fillStyle=r.color,o.fillRect(r.x,r.y,r.w,r.h),r.y+=r.s,r.a+=.1,r.y>e.confete.height&&(r.y=-10)}),e.confete.width>0&&requestAnimationFrame(a)}a(),setTimeout(()=>{e.confete.width=0},5e3)}window.iniciarJogo=x;window.iniciarModoTreino=E;window.verificarResposta=T;window.mostrarDica=B;window.transicaoProximaPergunta=J;window.resetarMemoriaSRS=q;window.enviarPontuacao=()=>alert("Implementar envio no novo m√≥dulo.");L();
